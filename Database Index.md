# Database Index

关于数据库索引的几个问题：
- 为什么要给表加上主键

　　索引必须要知道一种数据结构：平衡树(b tree/b+ tree)，主流的RDBMS都是把平衡树当做数据表默认的索引数据结构；我们平时创建表的时候都会为表加一个主键(关系性数据库默认建表时需要指定主键)，
事实上，加了一个主键的表已经并不能称之为“表”;一个没有加主键的表，它的数据无序的放置在磁盘的存储器上，一行一行的排列的很整齐，跟我们认知的"表"结构很接近。但是在加上了主键之后，表在磁盘上的存储结构就由整齐排列的结构转变成了树状结构，也就是b tree/b+ tree数据结构；此时整个表就变成了一个索引，也就是所谓的"聚集索引"。这就是没什么一个表只能有一个主键，一个表只能有一个"聚集索引"，因为主键的作用就是把'表'的数据格式转换成'索引'的格式放置。我们平时经常提起的索引属于非聚集索引，也叫常规索引，非聚集索引同样采用平衡树的数据结构，树结构中各节点的值来自于表中的索引字段，比如给user表的name字段加上索引，那么索引就是由name字段的值构成;给表中的多个字段设置索引就会出现多个独立的索引结构，各个索引之间不存在关联关系。非聚集索引首先通过树的数据结构找到记录对应的主键的值，在根据主键值在聚集索引的树结构中查找到需要的数据；而聚集索引即直接通过主键查找数据。

- 为什么加索引后会使查询变快

　　因为使用了b+ tree的数据结构，该数据结构在查找的算法上的效率提高很多，从而使得查询操作会变的很快

- 为什么加索引后会使写入、修改、删除便变慢

　　使用了树的数据结构之后，除了增加表的大小，增加了磁盘的存储；在写入、修改和删除数据时需要进行调整树的结构，以便继续维持树的数据结构特点，也即可以继续的加快查询的效率

- 什么情况下要同时在两个字段上建索引(复合索引) <??? ???>

　　所谓复合索引即在两个或以上列的字段建立一个索引，比如对user表的name,phone建立复合索引，此时... ...
